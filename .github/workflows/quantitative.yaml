name: Quantitative tests

on:
  pull_request_target:
    branches:
      - main

# Pin tool versions to prevent problems
permissions: {}
jobs:
  regression:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - name: "Checkout repo"
        uses: actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 # v6.0.0
        with:
          ref: ${{ github.event.pull_request.head.sha }}

      - name: "Checkout main repo"
        uses: actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 # v6.0.0
        with:
          repository: coreruleset/coreruleset
          ref: 'main'
          path: 'mainBranchFolder'

#      - name: "Run tests"
#        id: quantitative
#        run: |
#          ls
#          pwd

#          OLD_FALSE_POSITIVES=$(jq -r '.falsePositives' old.json)
#          NEW_FALSE_POSITIVES=$(jq -r '.falsePositives' new.json)
#          
#          echo $OLD_FALSE_POSITIVES
#          echo $NEW_FALSE_POSITIVES
#
#          if [ "$NEW_FALSE_POSITIVES" -gt "$OLD_FALSE_POSITIVES" ]; then
#            echo -e " âš ï¸ Quantitative testing detected new false positives"
#            echo -e "ðŸ“ Total false positives: \`$OLD_FALSE_POSITIVES\` -> \`$NEW_FALSE_POSITIVES\`\n<details>\n"
#            echo -e ""
#            echo -e "  <summary>Diff details</summary>\n\n\`\`\`\n"
#            diff <(jq . old_results.json) <(jq . new_results.json)
#            echo -e "\n\`\`\`\n</details>"
#          else
#            echo -e " ðŸš€ Quantitative testing did not detect new false positives"
#          fi

